# cypher script
# Neo4j 5.x

# 一、创建唯一约束
CREATE CONSTRAINT class_uri FOR (c:Class) REQUIRE c.uri IS UNIQUE;
CREATE CONSTRAINT category_unique FOR (c:Category) REQUIRE c.lineage IS UNIQUE;
CREATE CONSTRAINT concept_unique FOR (c:Concept) REQUIRE c.lineage IS UNIQUE;
CREATE CONSTRAINT sequencing_name FOR (n:Sequencing) REQUIRE n.name IS UNIQUE;
CREATE CONSTRAINT method_name FOR (n:Method) REQUIRE n.name IS UNIQUE;
CREATE CONSTRAINT omics_name FOR (n:Omics) REQUIRE n.name IS UNIQUE;
CREATE CONSTRAINT discipline_name FOR (n:Discipline) REQUIRE n.name IS UNIQUE;
CREATE CONSTRAINT platform_uri FOR (p:Platform) REQUIRE p.uri IS UNIQUE;
CREATE CONSTRAINT sample_uri FOR (s:Sample) REQUIRE s.uri IS UNIQUE;
CREATE CONSTRAINT run_uri FOR (r:Run) REQUIRE r.uri IS UNIQUE;
CREATE CONSTRAINT paper_doi FOR (p:Paper) REQUIRE p.doi IS UNIQUE;


# 二、构建本体层（分类与概念体系）
MERGE (seqClass:Class {uri:'bi:SequencingTechnology', label:'测序技术'});
MERGE (firstGenClass:Class {uri:'bi:FirstGeneration', label:'第一代测序'})-[:SUBCLASS_OF]->(seqClass);
MERGE (secondGenClass:Class {uri:'bi:SecondGeneration', label:'第二代测序'})-[:SUBCLASS_OF]->(seqClass);
MERGE (thirdGenClass:Class {uri:'bi:ThirdGeneration', label:'第三代测序'})-[:SUBCLASS_OF]->(seqClass);
MERGE (fourthGenClass:Class {uri:'bi:FourthGeneration', label:'第四代测序'})-[:SUBCLASS_OF]->(seqClass);

MERGE (omicsClass:Class {uri:'bi:Omics', label:'组学'});
MERGE (genomicsClass:Class {uri:'bi:Genomics', label:'基因组学'})-[:SUBCLASS_OF]->(omicsClass);
MERGE (epigenomicsClass:Class {uri:'bi:Epigenomics', label:'表观组学'})-[:SUBCLASS_OF]->(omicsClass);
MERGE (transcriptomicsClass:Class {uri:'bi:Transcriptomics', label:'转录组学'})-[:SUBCLASS_OF]->(omicsClass);
MERGE (proteomicsClass:Class {uri:'bi:Proteomics', label:'蛋白质组学'})-[:SUBCLASS_OF]->(omicsClass);
MERGE (metabolomicsClass:Class {uri:'bi:Metabolomics', label:'代谢组学'})-[:SUBCLASS_OF]->(omicsClass);
MERGE (microbiomicsClass:Class {uri:'bi:Microbiomics', label:'微生物组学'})-[:SUBCLASS_OF]->(omicsClass);
MERGE (emergingOmicsClass:Class {uri:'bi:EmergingOmics', label:'整合与新兴组学'})-[:SUBCLASS_OF]->(omicsClass);

MERGE (disciplineClass:Class {uri:'bi:Discipline', label:'学科领域'});
MERGE (methodClass:Class {uri:'bi:Methodology', label:'研究方法'})-[:SUBCLASS_OF]->(disciplineClass);
MERGE (applicationClass:Class {uri:'bi:Application', label:'应用场景'})-[:SUBCLASS_OF]->(disciplineClass);

MERGE (root:Category {name:"生物信息学本体", lineage:""});

MERGE (bioCategory:Category {name:"生物信息学", lineage:"生物信息学"})
MERGE (root)-[:HAS_SUBCATEGORY]->(bioCategory);

FOREACH (sub IN ["一般理论", "政策、伦理与规范及其阐述", "生物信息学与其他学科的关系", "生物信息学史", "生物医学信息学相关机构、团体"] |
  MERGE (subCat:Category {name:sub, lineage:"生物信息学/"+sub})
  MERGE (bioCategory)-[:HAS_SUBCATEGORY]->(subCat)
);

MERGE (seqCategory:Category {name:"测序技术", lineage:"测序技术"})
MERGE (root)-[:HAS_SUBCATEGORY]->(seqCategory);

MERGE (firstGenCat:Category {name:"第一代测序技术", lineage:"测序技术/第一代测序技术"})
MERGE (seqCategory)-[:HAS_SUBCATEGORY]->(firstGenCat);
FOREACH (con IN ["Sanger 链终止法","Maxam-Gilbert 化学降解法"] |
  MERGE (c:Concept {name:con, lineage:"测序技术/第一代测序技术/"+con})
  MERGE (firstGenCat)-[:CONTAINS]->(c)
  MERGE (c)-[:BELONGS_TO_CLASS]->(firstGenClass)
);

MERGE (secondGenCat:Category {name:"第二代测序技术", lineage:"测序技术/第二代测序技术"})
MERGE (seqCategory)-[:HAS_SUBCATEGORY]->(secondGenCat);
FOREACH (con IN ["Illumina SBS","Ion Torrent 半导体测序","BGISEQ/DNBSEQ 平台"] |
  MERGE (c:Concept {name:con, lineage:"测序技术/第二代测序技术/"+con})
  MERGE (secondGenCat)-[:CONTAINS]->(c)
  MERGE (c)-[:BELONGS_TO_CLASS]->(secondGenClass)
);

MERGE (thirdGenCat:Category {name:"第三代测序技术", lineage:"测序技术/第三代测序技术"})
MERGE (seqCategory)-[:HAS_SUBCATEGORY]->(thirdGenCat);
FOREACH (con IN ["PacBio SMRT","Oxford Nanopore"] |
  MERGE (c:Concept {name:con, lineage:"测序技术/第三代测序技术/"+con})
  MERGE (thirdGenCat)-[:CONTAINS]->(c)
  MERGE (c)-[:BELONGS_TO_CLASS]->(thirdGenClass)
);

MERGE (fourthGenCat:Category {name:"第四代测序与前沿技术", lineage:"测序技术/第四代测序与前沿技术"})
MERGE (seqCategory)-[:HAS_SUBCATEGORY]->(fourthGenCat);
FOREACH (con IN ["DNA 纳米球测序","原位测序","电子测序","量子测序"] |
  MERGE (c:Concept {name:con, lineage:"测序技术/第四代测序与前沿技术/"+con})
  MERGE (fourthGenCat)-[:CONTAINS]->(c)
  MERGE (c)-[:BELONGS_TO_CLASS]->(fourthGenClass)
);

MERGE (methodCategory:Category {name:"研究方法与分析算法", lineage:"研究方法与分析算法"})
MERGE (root)-[:HAS_SUBCATEGORY]->(methodCategory);

MERGE (expDesignCat:Category {name:"实验与统计设计", lineage:"研究方法与分析算法/实验与统计设计"})
MERGE (methodCategory)-[:HAS_SUBCATEGORY]->(expDesignCat);
FOREACH (con IN ["系统建模方法", "数理逻辑与图结构方法", "统计推断与实验设计原则", "计算建模策略与算法范式", "多学科整合方法"] |
  MERGE (c:Concept {name:con, lineage:"研究方法与分析算法/实验与统计设计/"+con})
  MERGE (expDesignCat)-[:CONTAINS]->(c)
  MERGE (c)-[:BELONGS_TO_CLASS]->(methodClass)
);

MERGE (dataAlgCat:Category {name:"数据分析通用算法", lineage:"研究方法与分析算法/数据分析通用算法"})
MERGE (methodCategory)-[:HAS_SUBCATEGORY]->(dataAlgCat);
FOREACH (con IN ["序列分析方法", "结构预测与建模方法", "变异检测", "网络与通路分析方法", "统计分析与建模方法", "多组学整合分析方法"] |
  MERGE (c:Concept {name:con, lineage:"研究方法与分析算法/数据分析通用算法/"+con})
  MERGE (dataAlgCat)-[:CONTAINS]->(c)
  MERGE (c)-[:BELONGS_TO_CLASS]->(methodClass)
);

MERGE (mlCat:Category {name:"机器学习与深度学习方法", lineage:"研究方法与分析算法/机器学习与深度学习方法"})
MERGE (methodCategory)-[:HAS_SUBCATEGORY]->(mlCat);
FOREACH (con IN ["监督学习", "深度学习", "图神经网络", "联邦学习与隐私计算", "可解释 AI"] |
  MERGE (c:Concept {name:con, lineage:"研究方法与分析算法/机器学习与深度学习方法/"+con})
  MERGE (mlCat)-[:CONTAINS]->(c)
  MERGE (c)-[:BELONGS_TO_CLASS]->(methodClass)
);

MERGE (wfConcept:Concept {name:"工作流与软件工程", lineage:"研究方法与分析算法/工作流与软件工程"})
MERGE (methodCategory)-[:CONTAINS]->(wfConcept)
MERGE (wfConcept)-[:BELONGS_TO_CLASS]->(methodClass);

MERGE (omicsCategory:Category {name:"组学", lineage:"组学"})
MERGE (root)-[:HAS_SUBCATEGORY]->(omicsCategory);

MERGE (genomicsCat:Category {name:"基因组学", lineage:"组学/基因组学"})
MERGE (omicsCategory)-[:HAS_SUBCATEGORY]->(genomicsCat);
FOREACH (sub IN ["结构基因组学", "功能基因组学", "比较基因组学", "群体与统计基因组学", "临床基因组学"] |
  MERGE (subCat:Category {name:sub, lineage:"组学/基因组学/"+sub})
  MERGE (genomicsCat)-[:HAS_SUBCATEGORY]->(subCat)
  MERGE (subCat)-[:BELONGS_TO_CLASS]->(genomicsClass)
);

MERGE (epigenomicsCat:Category {name:"表观组学", lineage:"组学/表观组学"})
MERGE (omicsCategory)-[:HAS_SUBCATEGORY]->(epigenomicsCat);
FOREACH (sub IN ["DNA甲基化组", "组蛋白修饰组", "染色质三维结构", "染色质可及性", "非编码 RNA 介导的表观调控"] |
  MERGE (subCat:Category {name:sub, lineage:"组学/表观组学/"+sub})
  MERGE (epigenomicsCat)-[:HAS_SUBCATEGORY]->(subCat)
  MERGE (subCat)-[:BELONGS_TO_CLASS]->(epigenomicsClass)
);

MERGE (transcriptomicsCat:Category {name:"转录组学", lineage:"组学/转录组学"})
MERGE (omicsCategory)-[:HAS_SUBCATEGORY]->(transcriptomicsCat);
FOREACH (sub IN ["mRNA表达组", "非编码RNA组", "转录调控组", "修饰转录组"] |
  MERGE (subCat:Category {name:sub, lineage:"组学/转录组学/"+sub})
  MERGE (transcriptomicsCat)-[:HAS_SUBCATEGORY]->(subCat)
  MERGE (subCat)-[:BELONGS_TO_CLASS]->(transcriptomicsClass)
);

MERGE (proteomicsCat:Category {name:"蛋白质组学", lineage:"组学/蛋白质组学"})
MERGE (omicsCategory)-[:HAS_SUBCATEGORY]->(proteomicsCat)
MERGE (proteomicsCat)-[:BELONGS_TO_CLASS]->(proteomicsClass);

MERGE (metabolomicsCat:Category {name:"代谢组学", lineage:"组学/代谢组学"})
MERGE (omicsCategory)-[:HAS_SUBCATEGORY]->(metabolomicsCat)
MERGE (metabolomicsCat)-[:BELONGS_TO_CLASS]->(metabolomicsClass);

MERGE (microbiomicsCat:Category {name:"微生物组学", lineage:"组学/微生物组学"})
MERGE (omicsCategory)-[:HAS_SUBCATEGORY]->(microbiomicsCat)
MERGE (microbiomicsCat)-[:BELONGS_TO_CLASS]->(microbiomicsClass);

MERGE (emergingOmicsCat:Category {name:"整合与新兴组学", lineage:"组学/整合与新兴组学"})
MERGE (omicsCategory)-[:HAS_SUBCATEGORY]->(emergingOmicsCat)
MERGE (emergingOmicsCat)-[:BELONGS_TO_CLASS]->(emergingOmicsClass);

MERGE (sanger:Sequencing:Gen1 {name:"Sanger", description:"Sanger 链终止法"})
MERGE (maxam:Sequencing:Gen1 {name:"Maxam_Gilbert", description:"Maxam-Gilbert 化学降解法"})
MERGE (illumina:Sequencing:Gen2 {name:"Illumina_SBS", description:"Illumina 边合成边测序"})
MERGE (ionTorrent:Sequencing:Gen2 {name:"Ion_Torrent", description:"Ion Torrent 半导体测序"})
MERGE (bgiseq:Sequencing:Gen2 {name:"BGISEQ_DNBSEQ", description:"华大智造 DNBSEQ 平台"})
MERGE (pacbio:Sequencing:Gen3 {name:"PacBio_SMRT", description:"PacBio 单分子实时测序"})
MERGE (nanopore:Sequencing:Gen3 {name:"Oxford_Nanopore", description:"牛津纳米孔测序"})
MERGE (dnaNanoball:Sequencing:Gen4 {name:"DNA_Nanoball_Sequencing", description:"DNA 纳米球测序"})

MERGE (sysModel:Method:ExperimentalDesign {name:"System_Modeling", description:"系统建模方法"})
MERGE (statInfer:Method:ExperimentalDesign {name:"Statistical_Inference", description:"统计推断与实验设计"})
MERGE (seqAnalysis:Method:Algorithm:Sequence {name:"Sequence_Analysis", description:"序列分析方法"})
MERGE (structPred:Method:Algorithm:Structure {name:"Structure_Prediction", description:"结构预测与建模方法"})
MERGE (varDetect:Method:Algorithm:Variant {name:"Variant_Detection", description:"变异检测算法"})
MERGE (netAnalysis:Method:Algorithm:Network {name:"Network_Analysis", description:"网络与通路分析方法"})
MERGE (supervisedML:Method:ML:Supervised {name:"Supervised_Learning", description:"监督学习"})
MERGE (deepLearning:Method:ML:Deep {name:"Deep_Learning", description:"深度学习"})
MERGE (gnn:Method:ML:Graph {name:"Graph_Neural_Network", description:"图神经网络"})
MERGE (xai:Method:ML:Explainable {name:"Explainable_AI", description:"可解释 AI"})
MERGE (workflow:Method:Workflow {name:"Workflow_Engineering", description:"工作流与软件工程"})

MERGE (structGen:Omics:Genomics {name:"Structural_Genomics", description:"结构基因组学"})
MERGE (funcGen:Omics:Genomics {name:"Functional_Genomics", description:"功能基因组学"})
MERGE (clinGen:Omics:Genomics {name:"Clinical_Genomics", description:"临床基因组学"})
MERGE (dnaMeth:Omics:Epigenomics {name:"DNAMethylation", description:"DNA甲基化组"})
MERGE (mrnaProfiling:Omics:Transcriptomics {name:"mRNA_Profiling", description:"mRNA表达组"})
MERGE (ncrna:Omics:Transcriptomics {name:"Noncoding_RNA", description:"非编码RNA组"})
MERGE (exprProt:Omics:Proteomics {name:"Expression_Proteomics", description:"表达蛋白质组"})
MERGE (microComp:Omics:Microbiome {name:"Microbial_Composition", description:"微生物菌群组成"})
MERGE (scRna:Omics:SingleCell {name:"scRNA_Seq", description:"单细胞转录组学"})
MERGE (multiOmics:Omics:Integrative {name:"Multi_Omics", description:"多组学整合"})

MERGE (bioinfo:Discipline {name:"Bioinformatics", description:"生物信息学一般理论"})
MERGE (bioEthics:Discipline:Policy {name:"Ethics_Policy", description:"政策、伦理与规范"})
MERGE (bioHistory:Discipline:History {name:"Bioinfo_History", description:"生物信息学史"})
MERGE (bioOrg:Discipline:Organization {name:"Bioinfo_Organization", description:"生物医学信息学相关机构"})



# 三、构建实例层（具体实体）
MATCH (illuConcept:Concept {lineage:"测序技术/第二代测序技术/Illumina SBS"})
FOREACH (instrument IN ["NovaSeq 6000","HiSeq X Ten","NextSeq 550","MiniSeq","iSeq 100"] |
  MERGE (i:Instance {name:instrument, lineage:"实例/仪器/"+instrument, type:"测序仪器"})
  MERGE (i)-[:ISA]->(illuConcept)
  MERGE (i)-[:USES_TECHNOLOGY]->(illumina)
);

MATCH (ionConcept:Concept {lineage:"测序技术/第二代测序技术/Ion Torrent 半导体测序"})
FOREACH (instrument IN ["Ion GeneStudio S5","Ion PGM","Ion Proton"] |
  MERGE (i:Instance {name:instrument, lineage:"实例/仪器/"+instrument, type:"测序仪器"})
  MERGE (i)-[:ISA]->(ionConcept)
  MERGE (i)-[:USES_TECHNOLOGY]->(ionTorrent)
);

MATCH (pacbioConcept:Concept {lineage:"测序技术/第三代测序技术/PacBio SMRT"})
FOREACH (instrument IN ["Sequel IIe","Revio"] |
  MERGE (i:Instance {name:instrument, lineage:"实例/仪器/"+instrument, type:"测序仪器"})
  MERGE (i)-[:ISA]->(pacbioConcept)
  MERGE (i)-[:USES_TECHNOLOGY]->(pacbio)
);

MATCH (nanoporeConcept:Concept {lineage:"测序技术/第三代测序技术/Oxford Nanopore"})
FOREACH (instrument IN ["MinION Mk1C","GridION","PromethION 48","Flongle"] |
  MERGE (i:Instance {name:instrument, lineage:"实例/仪器/"+instrument, type:"测序仪器"})
  MERGE (i)-[:ISA]->(nanoporeConcept)
  MERGE (i)-[:USES_TECHNOLOGY]->(nanopore)
);

MATCH (genomeConcept:Concept {lineage:"组学/基因组学/比较基因组学/物种间基因组"})
FOREACH (genome IN ["GRCh38.p14","T2T-CHM13 v2.0","GRCm39","Rnor_6.0","BDGP6.32"] |
  MERGE (i:Instance {name:genome, lineage:"实例/基因组/"+genome, type:"参考基因组"})
  MERGE (i)-[:ISA]->(genomeConcept)
  MERGE (i)-[:BELONGS_TO_OMICS]->(structGen)
);

MATCH (geneConcept:Concept {lineage:"组学/基因组学/功能基因组学/编码基因"})
FOREACH (annotation IN ["GENCODE v44","Ensembl v110","RefSeq 110","CHESS v3"] |
  MERGE (i:Instance {name:annotation, lineage:"实例/注释/"+annotation, type:"基因注释"})
  MERGE (i)-[:ISA]->(geneConcept)
  MERGE (i)-[:BELONGS_TO_OMICS]->(funcGen)
);

MATCH (varConcept:Concept {lineage:"研究方法与分析算法/数据分析通用算法/变异检测"})
FOREACH (db IN ["dbSNP build 156","gnomAD v3.1.2","ClinVar 2023-11","COSMIC v99"] |
  MERGE (i:Instance {name:db, lineage:"实例/数据库/"+db, type:"变异数据库"})
  MERGE (i)-[:ISA]->(varConcept)
  MERGE (i)-[:SUPPORTS_METHOD]->(varDetect)
);

MATCH (transcriptConcept:Concept {lineage:"组学/转录组学/mRNA表达组/全转录组"})
FOREACH (dataset IN ["GEO GSE183904","SRA SRP301921","ArrayExpress E-MTAB-10043"] |
  MERGE (i:Instance {name:dataset, lineage:"实例/数据集/"+dataset, type:"转录组数据集"})
  MERGE (i)-[:ISA]->(transcriptConcept)
  MERGE (i)-[:BELONGS_TO_OMICS]->(mrnaProfiling)
);

MATCH (proteinConcept:Concept {lineage:"组学/蛋白质组学/表达蛋白质组"})
FOREACH (dataset IN ["PRIDE PXD028735","MassIVE MSV000089728","jPOST JPST001234"] |
  MERGE (i:Instance {name:dataset, lineage:"实例/数据集/"+dataset, type:"蛋白质组数据集"})
  MERGE (i)-[:ISA]->(proteinConcept)
  MERGE (i)-[:BELONGS_TO_OMICS]->(exprProt)
);

MATCH (seqConcept:Concept {lineage:"研究方法与分析算法/序列分析方法"})
FOREACH (software IN ["BWA-MEM2","Bowtie2","minimap2","BLAST+ 2.14"] |
  MERGE (i:Instance {name:software, lineage:"实例/软件/"+software, type:"序列分析软件"})
  MERGE (i)-[:ISA]->(seqConcept)
  MERGE (i)-[:IMPLEMENTS_METHOD]->(seqAnalysis)
);

MATCH (dlConcept:Concept {lineage:"研究方法与分析算法/机器学习与深度学习方法/深度学习"})
FOREACH (software IN ["DeepVariant 1.5","ClinSV","DeepBind","AlphaFold2"] |
  MERGE (i:Instance {name:software, lineage:"实例/软件/"+software, type:"深度学习软件"})
  MERGE (i)-[:ISA]->(dlConcept)
  MERGE (i)-[:IMPLEMENTS_METHOD]->(deepLearning)
);

UNWIND [
  {name:"Drug Discovery & Development", keywords:["drug discovery","therapeutic target","drug repositioning"], type:"药物研发"},
  {name:"Cancer Omics", keywords:["cancer","oncology","biomarker","gastric cancer","SCLC"], type:"癌症研究"},
  {name:"Infectious Disease & Public Health", keywords:["microbial","virus","pathogen","public health","epidemiology"], type:"传染病与公共卫生"},
  {name:"Single-Cell & Spatial Omics", keywords:["single-cell","spatial transcriptomics","scRNA-seq","CTC"], type:"单细胞与空间组学"},
  {name:"Metagenomics & Microbiome", keywords:["metagenomics","microbiome","microbial ecology","biogas"], type:"宏基因组与微生物组"},
  {name:"Plant & Agricultural Genomics", keywords:["plant","crop","agriculture","drought stress","maize"], type:"植物与农业基因组学"},
  {name:"Metalloproteins & Trace-Element", keywords:["selenoprotein","metalloprotein","trace metal","metal-binding"], type:"金属蛋白与微量元素"},
  {name:"Non-coding RNA Research", keywords:["miRNA","lncRNA","ncRNA","cardiovascular"], type:"非编码RNA研究"},
  {name:"Education & Capacity Building", keywords:["education","training","curriculum","capacity building","Africa"], type:"教育与能力建设"},
  {name:"Clinical Genomics & Diagnostics", keywords:["clinical NGS","precision medicine","rare disease","diagnostics"], type:"临床基因组学与诊断"},
  {name:"Proteomics & Mass Spectrometry", keywords:["proteomics","mass spectrometry","SomaScan","urinary proteome"], type:"蛋白质组学与质谱"},
  {name:"Immunology & Allergy", keywords:["immunology","allergy","epitope","antigen","T-cell"], type:"免疫学与过敏"},
  {name:"Structural Bioinformatics", keywords:["structural bioinformatics","protein structure","AI structure prediction"], type:"结构生物信息学"},
  {name:"Neuropsychiatric Disorders", keywords:["neuropsychiatric","mental health","brain disorder"], type:"神经精神疾病"}
] AS app
MERGE (a:ApplicationArea:Instance {name:app.name})
SET 
  a.keywords = app.keywords,
  a.type = app.type,
  a.belongs_to_class = "bi:Application";

UNWIND [
  {doi:"10.1042/BSR20160180", title:"Bioinformatics in translational drug discovery", journal:"Biosci Rep", year:2017, omics:["Multi_Omics"], app:["Drug Discovery & Development"], tech:["Illumina_SBS"], method:["Variant_Detection","Network_Analysis"]},
  {doi:"10.1002/mnfr.200500273", title:"Introduction to bioinformatics", journal:"Mol Nutr Food Res", year:2006, omics:["Expression_Proteomics"], app:["Immunology & Allergy"]},
  {doi:"10.3390/ijms18122516", title:"Aptamer Bioinformatics", journal:"Int J Mol Sci", year:2017, omics:["Noncoding_RNA"], app:["Drug Discovery & Development"]},
  {doi:"10.3390/ijms25115880", title:"Bioinformatics Analysis of Gastric Cancer Markers", journal:"Int J Mol Sci", year:2024, omics:["Clinical_Genomics","Multi_Omics"], app:["Cancer Omics"]},
  {doi:"10.1371/journal.pbio.3001165", title:"Is 'bioinformatics' dead?", journal:"PLoS Biol", year:2021, app:["Education & Capacity Building"]},
  {doi:"10.1093/bib/bbx087", title:"Bioinformatics in the Netherlands", journal:"Brief Bioinform", year:2019, app:["Education & Capacity Building"]},
  {doi:"10.1089/ars.2020.8044", title:"Bioinformatics of Selenoproteins", journal:"Antioxid Redox Signal", year:2020, omics:["Comparative_Genomics"], app:["Metalloproteins & Trace-Element"]},
  {doi:"10.1016/j.jbiosc.2022.08.004", title:"Bioinformatics in bioscience", journal:"J Biosci Bioeng", year:2022, omics:["Multi_Omics"], app:["Plant & Agricultural Genomics"], tech:["Illumina_SBS"]},
  {doi:"10.3390/molecules25153366", title:"Bioinformatics of Metalloproteins", journal:"Molecules", year:2020, omics:["Comparative_Genomics"], app:["Metalloproteins & Trace-Element"]},
  {doi:"10.1016/j.cll.2020.02.003", title:"Bioinformatics in Clinical Genomic Sequencing", journal:"Clin Lab Med", year:2020, omics:["Clinical_Genomics"], app:["Clinical Genomics & Diagnostics"], tech:["Illumina_SBS"]},
  {doi:"10.1007/978-981-13-0502-3_4", title:"Single Cell RNA Sequencing Bioinformatics", journal:"Adv Exp Med Biol", year:2018, omics:["scRNA_Seq"], app:["Single-Cell & Spatial Omics"], tech:["Illumina_SBS"]},
  {doi:"10.1002/cbic.202200775", title:"Type II Polyketide Synthases Bioinformatics", journal:"Chembiochem", year:2023, app:["Drug Discovery & Development"]},
  {doi:"10.1111/imm.12987", title:"Bioinformatics for immunologists", journal:"Immunology", year:2018, app:["Immunology & Allergy"]},
  {doi:"10.1111/1751-7915.12389", title:"Microbial bioinformatics 2020", journal:"Microb Biotechnol", year:2016, omics:["Microbial_Composition"], app:["Metagenomics & Microbiome"]},
  {doi:"10.1016/j.jbi.2018.11.001", title:"Bioinformatics for Lung Cancer Targets", journal:"J Biomed Inform", year:2018, omics:["Clinical_Genomics"], app:["Cancer Omics"], method:["Network_Analysis"]},
  {doi:"10.1016/j.ymeth.2020.05.024", title:"Interpretable machine learning in bioinformatics", journal:"Methods", year:2020, method:["Explainable_AI"], app:["Education & Capacity Building"]},
  {doi:"10.3390/ijms21030961", title:"Bioinformatics for Renal Proteomics", journal:"Int J Mol Sci", year:2020, omics:["Expression_Proteomics"], app:["Proteomics & Mass Spectrometry"]},
  {doi:"10.1093/bib/bbv018", title:"Adapting bioinformatics curricula", journal:"Brief Bioinform", year:2016, app:["Education & Capacity Building"]},
  {doi:"10.1016/j.jbi.2022.104170", title:"Translational Bioinformatics for Personalized Medicine", journal:"J Biomed Inform", year:2022, app:["Clinical Genomics & Diagnostics"]},
  {doi:"10.1016/j.jbiotec.2017.08.012", title:"Metagenomics Bioinformatics for Biogas", journal:"J Biotechnol", year:2017, omics:["Microbial_Composition"], app:["Metagenomics & Microbiome"], tech:["Illumina_SBS"]},
  {doi:"10.1099/mgen.0.001051", title:"Bioinformatics in Public Health", journal:"Microb Genom", year:2023, app:["Infectious Disease & Public Health"]},
  {doi:"10.3390/ijms22062903", title:"Machine Learning in Bioinformatics", journal:"Int J Mol Sci", year:2021, method:["Deep_Learning"], app:["Education & Capacity Building"]},
  {doi:"10.1373/clinchem.2014.224360", title:"Bioinformatics for Clinical NGS", journal:"Clin Chem", year:2015, omics:["Clinical_Genomics"], app:["Clinical Genomics & Diagnostics"]},
  {doi:"10.1111/ppl.13672", title:"Bioinformatics for Plant Multiomics", journal:"Physiol Plant", year:2022, omics:["Multi_Omics"], app:["Plant & Agricultural Genomics"], tech:["Illumina_SBS"]},
  {doi:"10.1007/978-981-15-1671-9_2", title:"Non-coding RNA Bioinformatics", journal:"Adv Exp Med Biol", year:2020, omics:["Noncoding_RNA"], app:["Non-coding RNA Research"]},
  {doi:"10.1007/s12539-016-0147-x", title:"Bioinformatics in Hong Kong", journal:"Interdiscip Sci", year:2017, app:["Education & Capacity Building"]},
  {doi:"10.1093/bib/bbab461", title:"Positive-unlabeled learning in bioinformatics", journal:"Brief Bioinform", year:2022, method:["Supervised_Learning"], app:["Education & Capacity Building"]},
  {doi:"10.1007/978-3-0348-8458-7_14", title:"Bioinformatics in Protein Analysis", journal:"EXS", year:2000, omics:["Expression_Proteomics"], app:["Proteomics & Mass Spectrometry"]},
  {doi:"10.1002/2211-5463.13968", title:"Structural Bioinformatics", journal:"FEBS Open Bio", year:2025, omics:["Structural_Genomics"], app:["Structural Bioinformatics"]},
  {doi:"10.1007/978-1-4939-0847-9_9", title:"Bioinformatics for Neuropsychiatric Disorders", journal:"Methods Mol Biol", year:2014, app:["Neuropsychiatric Disorders"]},
  {doi:"10.1016/j.cmi.2017.12.015", title:"Microbial Bioinformatics for Nonbioinformaticians", journal:"Clin Microbiol Infect", year:2018, app:["Infectious Disease & Public Health"]},
  {doi:"10.1038/ng1109", title:"Bioinformatics in the Post-Sequence Era", journal:"Nat Genet", year:2003, omics:["Multi_Omics"], app:["Education & Capacity Building"]},
  {doi:"10.1007/978-1-0716-4595-6_9", title:"SomaScan Bioinformatics", journal:"Methods Mol Biol", year:2025, omics:["Expression_Proteomics"], app:["Proteomics & Mass Spectrometry"]},
  {doi:"10.1007/978-1-4939-6925-8_18", title:"Bioinformatics Tools for Allergy", journal:"Methods Mol Biol", year:2017, app:["Immunology & Allergy"]},
  {doi:"10.1016/j.meegid.2010.11.015", title:"Bioinformatics Education in Nigeria", journal:"Infect Genet Evol", year:2011, app:["Education & Capacity Building"]},
  {doi:"10.1016/j.jid.2017.07.095", title:"Bioinformatics for Genome-Scale Biology", journal:"J Invest Dermatol", year:2017, omics:["Clinical_Genomics"], app:["Clinical Genomics & Diagnostics"]},
  {doi:"10.1016/j.febslet.2009.03.035", title:"Proteomics Data Bioinformatics", journal:"FEBS Lett", year:2009, omics:["Expression_Proteomics"], app:["Proteomics & Mass Spectrometry"]},
  {doi:"10.1186/s12864-023-09454-7", title:"Bioinformatics for Wet-Lab Scientists", journal:"BMC Genomics", year:2023, omics:["Multi_Omics"], app:["Education & Capacity Building"]},
  {doi:"10.1016/j.parkreldis.2025.107311", title:"Bioinformatics in Genomic Diagnostics", journal:"Parkinsonism Relat Disord", year:2025, omics:["Clinical_Genomics"], app:["Clinical Genomics & Diagnostics"]}
] AS paperRow
MERGE (p:Paper:Instance {doi:paperRow.doi})
ON CREATE SET
  p.title = paperRow.title,
  p.journal = paperRow.journal,
  p.year = paperRow.year,
  p.omics = paperRow.omics,
  p.tech = paperRow.tech,
  p.method = paperRow.method,
  p.type = "学术论文";



# 四、构建关系（关联各层节点）
MERGE (seqClass:Class {uri:'bi:SequencingTechnology'})
MERGE (seqCategory:Category {name:"测序技术", lineage:"测序技术"})
MERGE (seqClass)-[:INCLUDES_CATEGORY]->(seqCategory);

MERGE (omicsClass:Class {uri:'bi:Omics'})
MERGE (omicsCategory:Category {name:"组学", lineage:"组学"})
MERGE (omicsClass)-[:INCLUDES_CATEGORY]->(omicsCategory);

MERGE (methodClass:Class {uri:'bi:Methodology'})
MERGE (methodCategory:Category {name:"研究方法与分析算法", lineage:"研究方法与分析算法"})
MERGE (methodClass)-[:INCLUDES_CATEGORY]->(methodCategory);

MERGE (illumina:Sequencing:Gen2 {name:"Illumina_SBS"})
MERGE (ionTorrent:Sequencing:Gen2 {name:"Ion_Torrent"})
MERGE (seqAnalysis:Method:Algorithm:Sequence {name:"Sequence_Analysis"})
MERGE (varDetect:Method:Algorithm:Variant {name:"Variant_Detection"})
MERGE (illumina)-[:APPLIES_METHOD]->(seqAnalysis)
MERGE (illumina)-[:APPLIES_METHOD]->(varDetect)
MERGE (ionTorrent)-[:APPLIES_METHOD]->(seqAnalysis)
MERGE (ionTorrent)-[:APPLIES_METHOD]->(varDetect);

MERGE (pacbio:Sequencing:Gen3 {name:"PacBio_SMRT"})
MERGE (nanopore:Sequencing:Gen3 {name:"Oxford_Nanopore"})
MERGE (structPred:Method:Algorithm:Structure {name:"Structure_Prediction"})
MERGE (pacbio)-[:APPLIES_METHOD]->(structPred)
MERGE (nanopore)-[:APPLIES_METHOD]->(structPred);

MERGE (clinGen:Omics:Genomics {name:"Clinical_Genomics"})
MERGE (scRna:Omics:SingleCell {name:"scRNA_Seq"})
MERGE (microComp:Omics:Microbiome {name:"Microbial_Composition"})
MERGE (illumina:Sequencing:Gen2 {name:"Illumina_SBS"})
MERGE (nanopore:Sequencing:Gen3 {name:"Oxford_Nanopore"})
MERGE (clinGen)-[:USES_TECHNOLOGY]->(illumina)
MERGE (clinGen)-[:USES_TECHNOLOGY]->(nanopore)
MERGE (scRna)-[:USES_TECHNOLOGY]->(illumina)
MERGE (microComp)-[:USES_TECHNOLOGY]->(illumina);

MERGE (structGen:Omics:Genomics {name:"Structural_Genomics"})
MERGE (funcGen:Omics:Genomics {name:"Functional_Genomics"})
MERGE (clinGen:Omics:Genomics {name:"Clinical_Genomics"})
MERGE (structGen)-[:HAS_SUBFIELD]->(funcGen)
MERGE (funcGen)-[:HAS_SUBFIELD]->(clinGen);

MERGE (dnaMeth:Omics:Epigenomics {name:"DNAMethylation"})
MERGE (histMod:Omics:Epigenomics {name:"Histone_Modification"})
MERGE (dnaMeth)-[:HAS_SUBFIELD]->(histMod);

MERGE (scRna:Omics:SingleCell {name:"scRNA_Seq"})
MERGE (multiOmics:Omics:Integrative {name:"Multi_Omics"})
MERGE (scRna)-[:HAS_SUBFIELD]->(multiOmics);

MATCH (p:Paper:Instance)
WHERE p.app IS NOT NULL
UNWIND p.app AS appName
MATCH (a:ApplicationArea:Instance {name:appName})
MERGE (p)-[:ADDRESSES_APPLICATION]->(a);

MATCH (p:Paper:Instance)
WHERE p.omics IS NOT NULL
UNWIND p.omics AS omicName
MATCH (o:Omics {name:omicName})
MERGE (p)-[:STUDIES_OMICS]->(o);

MATCH (p:Paper:Instance)
WHERE p.tech IS NOT NULL
UNWIND p.tech AS techName
MATCH (t:Sequencing {name:techName})
MERGE (p)-[:USES_TECHNOLOGY]->(t);

MATCH (p:Paper:Instance)
WHERE p.method IS NOT NULL
UNWIND p.method AS methName
MATCH (m:Method {name:methName})
MERGE (p)-[:APPLIES_METHOD]->(m);

MATCH (a:ApplicationArea:Instance {name:"Cancer Omics"})
MATCH (o:Omics:Genomics {name:"Clinical_Genomics"})
MERGE (a)-[:LEVERAGES_OMICS]->(o);

MATCH (a:ApplicationArea:Instance {name:"Metagenomics & Microbiome"})
MATCH (t:Sequencing:Gen2 {name:"Illumina_SBS"})
MERGE (a)-[:USES_TECHNOLOGY]->(t);

MATCH (a:ApplicationArea:Instance {name:"Drug Discovery & Development"})
MATCH (m1:Method:Algorithm:Variant {name:"Variant_Detection"})
MATCH (m2:Method:Algorithm:Network {name:"Network_Analysis"})
MERGE (a)-[:USES_METHOD]->(m1)
MERGE (a)-[:USES_METHOD]->(m2);

MATCH (a:ApplicationArea:Instance {name:"Clinical Genomics & Diagnostics"})
MATCH (o:Omics:Genomics {name:"Clinical_Genomics"})
MATCH (t:Sequencing:Gen2 {name:"Illumina_SBS"})
MERGE (a)-[:LEVERAGES_OMICS]->(o)
MERGE (a)-[:USES_TECHNOLOGY]->(t);

MERGE (bioinfo:Discipline {name:"Bioinformatics"})
WITH bioinfo
MATCH (t:Sequencing)
MERGE (bioinfo)-[:HAS_TECHNOLOGY]->(t);

MERGE (bioinfo:Discipline {name:"Bioinformatics"})
WITH bioinfo
MATCH (m:Method)
MERGE (bioinfo)-[:HAS_METHOD]->(m);

MERGE (bioinfo:Discipline {name:"Bioinformatics"})
WITH bioinfo
MATCH (o:Omics)
MERGE (bioinfo)-[:STUDIES_OMICS]->(o);

MERGE (bioinfo:Discipline {name:"Bioinformatics"})
WITH bioinfo
MATCH (a:ApplicationArea:Instance)
MERGE (bioinfo)-[:APPLIES_TO_SCENARIO]->(a);


# 五、验证知识图谱完整性
MATCH (c:Class)-[:INCLUDES_CATEGORY]->(cat:Category)
RETURN c.label AS 顶层分类, cat.name AS 层级分类, count(*) AS 下级概念数
ORDER BY c.label;

MATCH (i:Instance {type:"测序仪器"})-[:USES_TECHNOLOGY]->(t:Sequencing)
RETURN i.name AS 仪器实例, t.name AS 关联技术, t.description AS 技术描述
LIMIT 10;

MATCH (p:Paper:Instance)
OPTIONAL MATCH (p)-[:ADDRESSES_APPLICATION]->(a)
OPTIONAL MATCH (p)-[:STUDIES_OMICS]->(o)
OPTIONAL MATCH (p)-[:USES_TECHNOLOGY]->(t)
RETURN 
  p.doi AS 论文DOI,
  p.title AS 论文标题,
  a.name AS 应用领域,
  o.name AS 研究组学,
  t.name AS 使用技术
LIMIT 5;

MATCH (a:ApplicationArea:Instance)-[:USES_METHOD]->(m:Method)
RETURN a.name AS 应用领域, collect(m.name) AS 关联方法
LIMIT 8;

# 六、展示
MATCH (n)-[r]->(m)
RETURN n, r, m